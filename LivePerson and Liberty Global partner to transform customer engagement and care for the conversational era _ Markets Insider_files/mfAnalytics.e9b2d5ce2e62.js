window.mf=function(){"use strict";function e(){this._page={domain:window.location.host||"",href:window.location.href||"",path:window.location.pathname||"",protocol:window.location.protocol||"",referrer:document.referrer||"",search:window.location.search||"",title:document.title||"",url:window.location.protocol+"//"+window.location.host+window.location.pathname||""},this._campaignObj={medium:a("utm_medium")||"",name:a("utm_campaign")||"",source:a("utm_source")||""},this._analytics_key="yuH27H1QId6afXAojow6Tafi7Vw9v1spaLD5Yznw",this._MF="undefined"!=typeof MF?MF:{}}function t(e,t,r,n,i){var a=new XMLHttpRequest;r&&(a.onreadystatechange=function(){a.readyState==a.DONE&&r.apply(i,[a.response])}),a.open(e,t,!0),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("Accept","application/json"),a.setRequestHeader("x-api-key",i._analytics_key),a.send(n)}function r(e){var t;if(null===e||"object"!=typeof e)return e;if(e instanceof Date)return t=new Date,t.setTime(e.getTime()),t;if(e instanceof Array){t=[];for(var n=0,i=e.length;n<i;n++)t[n]=r(e[n]);return t}if(e instanceof Object){t={};for(var a in e)e.hasOwnProperty(a)&&(t[a]=r(e[a]));return t}throw new Error("Unable to copy obj! Its type isn't supported.")}function n(e,t,r){var n;if(r){var i=new Date;i.setTime(i.getTime()+24*r*60*60*1e3),n="; expires="+i.toGMTString()}else n="";document.cookie=e+"="+t+n+"; path=/"}function i(e,t,n,i){var c=n||{},p=i._adUnit,d=i._campaignObj,m=i._MF?s(r(i._MF),c):{},u=_(),l=i._page,g=i._posts,f=o(),h={anonymousId:f,context:{campaign:{medium:d.medium||"",name:d.name||"",source:d.source||""},ip:m.ip_address||"",page:{path:l.path,referrer:l.referrer,search:l.search,title:l.title,url:l.url},userAgent:m.user_agent||""},event:t,formatted:!0,messageId:u,properties:{browser_family:m.browser_family||"",browser_version_major:m.browser_version_major||"",browser_version_minor:m.browser_version_minor||"",campaign:m.campaign||"",campaign_id:m.campaign_id||"",campaign_reporting_id:m.campaign_reporting_id||"",city:m.city||"",country:m.country||"",device_brand:m.device_brand||"",device_family:m.device_family||"",device_model:m.device_model||"",domain:l.domain,initial_referrer:m.initial_referrer||"",ip_address:m.ip_address||"",landing_page:m.landing_page||"",mf_event_id:u,mktg_hline:a("mktg_hline")||m.mktg_hline,mktg_image:a("mktg_image")||m.mktg_image,num_pages_viewed:m.num_pages_viewed||1,os_family:m.os_family||"",os_version_major:m.os_version_major||"",os_version_minor:m.os_version_minor||"",placement_name:m.placement_name||"",postal_code:m.postal_code||"",protocol:l.protocol,referring_publisher:a("referring_publisher")||"",s1:a("s1")||"",s2:a("s2")||"",s3:a("s3")||"",screen_height:screen.height||"",screen_width:screen.width||"",state:m.state||"",tz_offset:(new Date).getTimezoneOffset(),user_agent:m.user_agent||"",utm_content:a("utm_content")||m.utm_content,value:m.value||"",widget_uuid:i._widget_id||""},timestamp:(new Date).toISOString(),type:e,userId:m.user_id||"",writeKey:i._key||""};if(g){h.properties.posts=[];var w;for(w=0;w<g.length;w++){var v=g[w];h.properties.posts.push({post_id:v.id,headline_id:v.headline_id,image_id:v.image_id})}}return p&&(h.properties.ad_unit=p.name,h.properties.ad_unit_id=p.id,h.properties.ad_unit_selector=p.selector,h.properties.ad_unit_updated_selector=p.updatedSelector||"",h.properties.campaign=p.campaign.name,h.properties.campaign_id=p.campaign.id,h.properties.campaign_reporting_id=p.campaign.reporting_id),h.properties=s(h.properties,m),h}function a(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),n=r.exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function o(){var e=c("_mfuuid_");if(e)var t=e;else{var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)});n("_mfuuid_",t,365)}return t}function s(e,t){if(t.constructor==Object)for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r]);return e}function c(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var i=r[n];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return i.substring(t.length,i.length)}return null}function p(e,r,n,a,o){o?o&&!o.formatted&&(o=i(e,r,n,a)):o=i(e,r,n,a),"function"==typeof _logAnalytic&&(a.hasOwnProperty("_adUnit")?_logAnalytic(o,a._adUnit):_logAnalytic(o)),a._noEvents||t("POST","https://analytics.myfinance.com/prod/record",null,JSON.stringify(o),a)}function _(){var e,t="";for(e=0;e<32;e+=1)switch(e){case 8:case 20:t+="-",t+=(16*Math.random()|0).toString(16);break;case 12:t+="-",t+="4";break;case 16:t+="-",t+=(4*Math.random()|8).toString(16);break;default:t+=(16*Math.random()|0).toString(16)}return t}return e.prototype.track=function(e,t){p("track",e,t,this)},e.prototype.campaignResolutionHandler=function(e){var t=this,r=JSON.parse(e).tracking;if(r?this._MF=r:console.log("Error parsing JSON response"),this._trackingObj)for(var n=0;n<this._trackingObj.length;n++)"event"===this._trackingObj[n].tracking&&p("track",this._trackingObj[n].name,null,t)},new e}();
